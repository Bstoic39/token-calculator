<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LayerDrone — Points → Tokens Estimator</title>
    <style>
      :root{
        /* LayerDrone-ish palette (green/black) */
        --bg: #060906;
        --panel: #0b120b;
        --panel2: #0a0f0a;
        --text: #e9ffe9;
        --muted: rgba(233,255,233,.72);
        --border: rgba(0,255,102,.22);
        --border2: rgba(233,255,233,.14);
        --green: #00ff66;
        --green2: rgba(0,255,102,.12);
        --danger: #ff3b3b;
        --shadow: 0 14px 40px rgba(0,0,0,.55);

        color-scheme: dark;
      }

      *{ box-sizing: border-box; }
      body{
        margin:0;
        padding: 22px;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
        background: radial-gradient(1200px 500px at 30% -10%, rgba(0,255,102,.10), transparent 60%),
                    radial-gradient(900px 500px at 90% 10%, rgba(0,255,102,.06), transparent 65%),
                    var(--bg);
        color: var(--text);
        display:grid;
        place-items:center;
      }

      .wrap{ width: min(860px, 100%); }
      .top{
        display:flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 12px;
        margin-bottom: 12px;
      }
      h1{
        margin:0;
        font-size: 18px;
        letter-spacing: .2px;
      }
      .sub{
        margin: 6px 0 0;
        color: var(--muted);
        font-size: 12.5px;
        line-height: 1.35;
      }

      .btn{
        border: 1px solid var(--border);
        background: linear-gradient(180deg, rgba(0,255,102,.10), rgba(0,255,102,.05));
        color: var(--text);
        border-radius: 12px;
        padding: 10px 12px;
        font-size: 12px;
        cursor: pointer;
        user-select:none;
        box-shadow: 0 8px 22px rgba(0,0,0,.35);
      }
      .btn:hover{ border-color: rgba(0,255,102,.35); }
      .btn:active{ transform: translateY(1px); }

      .card{
        background: linear-gradient(180deg, rgba(0,255,102,.06), transparent 70%),
                    var(--panel);
        border: 1px solid var(--border);
        border-radius: 16px;
        box-shadow: var(--shadow);
        padding: 16px;
      }

      .grid{
        display:grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 12px;
      }
      .col6{ grid-column: span 12; }
      @media (min-width: 780px){
        .col6{ grid-column: span 6; }
      }

      label{
        display:block;
        font-size: 12px;
        color: var(--muted);
        margin: 0 0 6px;
      }
      .hint{
        margin-top: 6px;
        font-size: 12px;
        color: var(--muted);
      }

      input[type="number"]{
        width:100%;
        padding: 10px 12px;
        border-radius: 12px;
        border: 1px solid var(--border2);
        background: var(--panel2);
        color: var(--text);
        outline:none;
      }
      input[type="number"]::placeholder{ color: rgba(233,255,233,.35); }
      input[type="number"]:focus{
        border-color: rgba(0,255,102,.45);
        box-shadow: 0 0 0 4px rgba(0,255,102,.10);
      }

      .row{
        display:flex;
        gap: 8px;
        align-items:center;
        flex-wrap: wrap;
      }

      .chip{
        border: 1px solid var(--border);
        background: var(--green2);
        color: var(--text);
        border-radius: 999px;
        padding: 7px 10px;
        font-size: 12px;
        cursor:pointer;
        user-select:none;
      }
      .chip:hover{ border-color: rgba(0,255,102,.40); }

      .priceBox{
        display:grid;
        gap: 10px;
      }
      input[type="range"]{
        width:100%;
        accent-color: var(--green);
      }
      .rangeMeta{
        display:flex;
        justify-content: space-between;
        color: var(--muted);
        font-size: 12px;
        margin-top: -6px;
      }

      .error{
        margin-top: 10px;
        padding: 10px 12px;
        border-radius: 12px;
        border: 1px solid rgba(255,59,59,.45);
        background: rgba(255,59,59,.08);
        font-size: 12px;
        color: rgba(255,220,220,.95);
      }

      .results{
        margin-top: 14px;
        border-top: 1px solid var(--border);
        padding-top: 14px;
        display:grid;
        gap: 10px;
      }

      .kpis{
        display:grid;
        grid-template-columns: 1fr;
        gap: 10px;
      }
      @media (min-width: 780px){
        .kpis{ grid-template-columns: repeat(3, 1fr); }
      }
      .kpi{
        padding: 12px;
        border-radius: 12px;
        border: 1px solid var(--border2);
        background: rgba(0,0,0,.12);
      }
      .kpi .t{ font-size: 12px; color: var(--muted); }
      .kpi .v{ margin-top: 4px; font-size: 18px; font-weight: 800; }
      .kpi .v.green{ color: var(--green); }

      .valueLine{
        display:flex;
        justify-content: space-between;
        align-items: baseline;
        gap: 10px;
        flex-wrap: wrap;
        padding: 12px;
        border-radius: 12px;
        border: 1px solid rgba(0,255,102,.28);
        background: rgba(0,255,102,.06);
      }
      .valueLine .big{
        font-size: 18px;
        font-weight: 900;
        color: var(--green);
      }
      .valueLine .meta{
        font-size: 12px;
        color: var(--muted);
      }

      details{ margin-top: 6px; }
      summary{
        cursor:pointer;
        font-size: 12px;
        color: var(--muted);
      }
      .detailsBody{
        margin-top: 8px;
        font-size: 12px;
        color: var(--muted);
        line-height: 1.45;
      }

      .disclaimer{
        margin-top: 12px;
        font-size: 12px;
        color: var(--muted);
        line-height: 1.35;
      }

      .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="top">
        <div>
          <h1>LayerDrone — Points → Tokens Estimator</h1>
          <p class="sub">
            Enter RP and/or XP points to estimate token allocation and an <span class="mono">estimated USD value</span> at a token price you set.
          </p>
        </div>
        <button class="btn" id="resetBtn" type="button">Reset</button>
      </div>

      <div class="card">
        <div class="grid">
          <div class="col6">
            <label>RP (Reputation Points)</label>
            <input id="rpInput" type="number" inputmode="decimal" min="0" step="0.01" placeholder="Leave blank if none" />
            <div class="hint">Demo ratio: <span class="mono">2 RP = 1 token</span></div>

            <div style="height: 12px;"></div>

            <label>XP (Experience Points)</label>
            <input id="xpInput" type="number" inputmode="decimal" min="0" step="0.01" placeholder="Leave blank if none" />
            <div class="hint">Demo ratio: <span class="mono">10 XP = 1 token</span></div>

            <div id="errorBox" class="error" style="display:none;"></div>
          </div>

          <div class="col6">
            <label>Token price (USD)</label>

            <div class="priceBox">
              <div class="row" aria-label="Preset token prices">
                <span class="hint" style="margin-right: 2px;">Presets:</span>
                <button class="chip preset" type="button" data-price="0.001">$0.001</button>
                <button class="chip preset" type="button" data-price="0.010">$0.010</button>
                <button class="chip preset" type="button" data-price="0.100">$0.100</button>
                <button class="chip preset" type="button" data-price="1.000">$1.000</button>
                <button class="chip preset" type="button" data-price="10.000">$10.000</button>
              </div>

              <input id="priceRange" type="range" min="0.001" max="10" step="0.001" value="0.100" />
              <div class="rangeMeta"><span>$0.001</span><span>$10.000</span></div>

              <div class="row" style="justify-content: space-between;">
                <input
                  id="priceInput"
                  type="number"
                  inputmode="decimal"
                  min="0.001"
                  max="10"
                  step="0.001"
                  value="0.100"
                  style="max-width: 220px;"
                />
                <div class="hint">Editable • 3 decimals • synced</div>
              </div>
            </div>

            <div class="results">
              <div class="kpis">
                <div class="kpi">
                  <div class="t">Tokens from RP</div>
                  <div class="v" id="tokensRP">0</div>
                </div>
                <div class="kpi">
                  <div class="t">Tokens from XP</div>
                  <div class="v" id="tokensXP">0</div>
                </div>
                <div class="kpi">
                  <div class="t">Total tokens</div>
                  <div class="v green" id="tokensTotal">0</div>
                </div>
              </div>

              <div class="valueLine">
                <div>
                  <div class="meta">Estimated USD value (floored)</div>
                  <div class="big" id="usdValue">$0.00</div>
                </div>
                <div class="meta" id="usdNote">at $0.100</div>
              </div>

              <details>
                <summary>Details</summary>
                <div class="detailsBody">
                  <div id="mathRP">RP tokens = RP ÷ 2</div>
                  <div id="mathXP">XP tokens = XP ÷ 10</div>
                  <div id="mathValue">USD value = total tokens × token price (floored to cents)</div>
                </div>
              </details>

              <div class="disclaimer">
                <strong>Disclaimer:</strong> Estimates only. Demo conversion ratios are hardcoded for internal testing and may change.
                Token price is user-provided and does not reflect market price. Final allocations, eligibility, and rounding rules are subject
                to official terms. :contentReference[oaicite:2]{index=2}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const els = {
        rpInput: document.getElementById("rpInput"),
        xpInput: document.getElementById("xpInput"),
        priceRange: document.getElementById("priceRange"),
        priceInput: document.getElementById("priceInput"),
        presetBtns: Array.from(document.querySelectorAll(".preset")),
        resetBtn: document.getElementById("resetBtn"),

        tokensRP: document.getElementById("tokensRP"),
        tokensXP: document.getElementById("tokensXP"),
        tokensTotal: document.getElementById("tokensTotal"),
        usdValue: document.getElementById("usdValue"),
        usdNote: document.getElementById("usdNote"),

        mathRP: document.getElementById("mathRP"),
        mathXP: document.getElementById("mathXP"),
        mathValue: document.getElementById("mathValue"),

        errorBox: document.getElementById("errorBox"),
      };

      const DEFAULT_PRICE = 0.1;

      function clamp(n, min, max){ return Math.min(max, Math.max(min, n)); }
      function toNumber(v){
        const n = Number(v);
        return Number.isFinite(n) ? n : NaN;
      }

      // Accept decimals up to 2 places (as previously requested)
      function normalizePoints(v){
        if (v === "" || v === null || v === undefined) return 0;
        const n = toNumber(v);
        if (!Number.isFinite(n)) return NaN;
        const c = clamp(n, 0, 1e15);
        return Math.round(c * 100) / 100;
      }

      // Price: 3 decimals, within slider bounds
      function normalizePrice(v){
        const n = toNumber(v);
        if (!Number.isFinite(n)) return NaN;
        const c = clamp(n, 0.001, 10);
        return Math.round(c * 1000) / 1000;
      }

      function formatUpTo8(n){
        const r = Math.round(n * 1e8) / 1e8;
        let s = r.toFixed(8).replace(/\.?0+$/, "");
        if (s === "" || s === "-0") s = "0";
        return s;
      }

      function floorToCents(n){
        return Math.floor(n * 100) / 100;
      }

      function showError(msg){
        if (!msg){
          els.errorBox.style.display = "none";
          els.errorBox.textContent = "";
          return;
        }
        els.errorBox.style.display = "block";
        els.errorBox.textContent = msg;
      }

      function setPrice(p){
        const price = normalizePrice(p);
        if (!Number.isFinite(price)) return;
        els.priceRange.value = String(price);
        els.priceInput.value = price.toFixed(3);
      }

      function compute(){
        showError("");

        const price = normalizePrice(els.priceInput.value);
        if (!Number.isFinite(price)){
          showError("Token price must be a number between 0.001 and 10.000.");
          return;
        }
        els.priceInput.value = price.toFixed(3);
        els.priceRange.value = String(price);

        const rp = normalizePoints(els.rpInput.value);
        const xp = normalizePoints(els.xpInput.value);

        if (!Number.isFinite(rp) || !Number.isFinite(xp)){
          showError("RP/XP must be numbers (you can leave either blank).");
          return;
        }

        // Demo ratios
        const tokensFromRP = rp / 2;
        const tokensFromXP = xp / 10;
        const totalTokens = tokensFromRP + tokensFromXP;

        const usd = floorToCents(totalTokens * price);

        els.tokensRP.textContent = formatUpTo8(tokensFromRP);
        els.tokensXP.textContent = formatUpTo8(tokensFromXP);
        els.tokensTotal.textContent = formatUpTo8(totalTokens);

        els.usdValue.textContent = `$${usd.toFixed(2)}`;
        els.usdNote.textContent = `at $${price.toFixed(3)}`;

        els.mathRP.textContent = `RP tokens = ${rp} ÷ 2 = ${formatUpTo8(tokensFromRP)}`;
        els.mathXP.textContent = `XP tokens = ${xp} ÷ 10 = ${formatUpTo8(tokensFromXP)}`;
        els.mathValue.textContent = `USD value = ${formatUpTo8(totalTokens)} × $${price.toFixed(3)} = $${usd.toFixed(2)} (floored)`;
      }

      // Events
      els.rpInput.addEventListener("input", compute);
      els.xpInput.addEventListener("input", compute);

      els.priceRange.addEventListener("input", () => {
        setPrice(els.priceRange.value);
        compute();
      });

      els.priceInput.addEventListener("input", () => {
        // typing stays allowed; we normalize and resync
        setPrice(els.priceInput.value);
        compute();
      });

      els.presetBtns.forEach(btn => {
        btn.addEventListener("click", () => {
          setPrice(btn.dataset.price);
          compute();
        });
      });

      els.resetBtn.addEventListener("click", () => {
        els.rpInput.value = "";
        els.xpInput.value = "";
        setPrice(DEFAULT_PRICE);
        compute();
      });

      // Init
      setPrice(DEFAULT_PRICE);
      compute();
    </script>
  </body>
</html>
